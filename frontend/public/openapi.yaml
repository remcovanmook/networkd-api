openapi: 3.0.0
info:
  title: Networkd API
  description: API for managing systemd-networkd configurations and system state.
  version: 1.2.0
servers:
  - url: http://localhost:8080
paths:
  /api/system/status:
    get:
      summary: Get System Status
      description: Returns system details including detected systemd version and active runtime interfaces.
      responses:
        '200':
          description: System status
          content:
            application/json:
              schema:
                type: object
                properties:
                  systemd_version:
                    type: string
                  interfaces:
                    type: array
                    items:
                      type: object

  /api/schemas:
    get:
      summary: Get Loaded JSON Schemas
      description: Returns the raw JSON schemas for networkd configuration files.
      responses:
        '200':
          description: Map of schemas

  /api/netdevs:
    get:
      summary: List NetDev Files
      description: Returns a list of all stored `.netdev` files.
      responses:
        '200':
          description: List of files
    post:
      summary: Create NetDev File
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [filename, config]
              properties:
                filename: {type: string}
                config: {type: object}
      responses:
        '201': {description: Created}

  /api/netdevs/{filename}:
    get:
      summary: Get NetDev Content
      parameters:
        - name: filename
          in: path
          required: true
          schema: {type: string}
      responses:
        '200': {description: Content}
    delete:
      summary: Delete NetDev File
      parameters:
        - name: filename
          in: path
          required: true
          schema: {type: string}
      responses:
        '204': {description: Deleted}

  /api/networks:
    get:
      summary: List Network Files
      description: Returns a list of all stored `.network` files.
      responses:
        '200':
          description: List of files
    post:
      summary: Create Network File
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [filename, config]
              properties:
                filename: {type: string}
                config: {type: object}
      responses:
        '201': {description: Created}

  /api/networks/{filename}:
    get:
      summary: Get Network Content
      parameters:
        - name: filename
          in: path
          required: true
          schema: {type: string}
      responses:
        '200': {description: Content}
    delete:
      summary: Delete Network File
      parameters:
        - name: filename
          in: path
          required: true
          schema: {type: string}
      responses:
        '204': {description: Deleted}

  /api/links:
    get:
      summary: List Link Files
      description: Returns a list of all stored `.link` files.
      responses:
        '200':
          description: List of files
    post:
      summary: Create Link File
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [filename, config]
              properties:
                filename: {type: string}
                config: {type: object}
      responses:
        '201': {description: Created}

  /api/links/{filename}:
    get:
      summary: Get Link Content
      parameters:
        - name: filename
          in: path
          required: true
          schema: {type: string}
      responses:
        '200': {description: Content}
    delete:
      summary: Delete Link File
      parameters:
        - name: filename
          in: path
          required: true
          schema: {type: string}
      responses:
        '204': {description: Deleted}

  # System Management
  /api/system/config:
    get:
      summary: Get global networkd.conf
      responses:
        '200': {description: Content}
    post:
      summary: Save global networkd.conf
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                content: {type: string}
      responses:
        '200': {description: Saved}

  /api/system/reload:
    post:
      summary: Reload systemd-networkd
      responses:
        '200': {description: Success}

  /api/system/reconfigure:
    get:
      summary: Reconfigure all interfaces
      description: Triggers networkctl reconfigure for all devices.
      responses:
        '200': {description: Triggered}
    post:
      summary: Reconfigure specific or all interfaces
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                interfaces:
                  type: array
                  items:
                    type: string
      responses:
        '200': {description: Triggered}
  
  /api/system/routes:
    get:
      summary: Get routing tables
      responses:
        '200': {description: Output}

  /api/system/logs:
    get:
      summary: Get logs
      responses:
        '200': {description: Log tail}
